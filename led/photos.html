<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Graduation Memories - Full Screen Scatter</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Pretendard:wght@700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Archivo+Black&family=Dongle&family=Gamja+Flower&family=Moirai+One&display=swap');

        body {
            margin: 0 auto; padding: 0;
            width: 860px; height: 1034px;
            overflow: hidden;
            background: url('images/background_p.png') no-repeat center center;
            background-size: cover;
            font-family: 'Pretendard', sans-serif;
            position: relative;
        }

        body::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 253, 245, 0.4); 
            z-index: 0;
        }

        #photo-container {
            position: relative;
            width: 860px; height: 1034px;
            z-index: 1;
        }

        .header-title {
            position: absolute;
            top: 40px; width: 100%;
            text-align: center;
            font-family: "Dongle", sans-serif;
            font-size: 50px;
            color: #2c3e50;
            z-index: 1000;
            text-shadow: 2px 2px 10px rgba(255,255,255,0.9);
            pointer-events: none;
        }

        .stacked-photo {
            position: absolute;
            width: 300px; /* 모서리 활용을 위해 크기를 살짝 더 줄임 */
            padding: 10px 10px 40px 10px; 
            background: white;
            box-shadow: 5px 12px 25px rgba(0,0,0,0.2);
            border-radius: 2px;
            opacity: 0;
            transform: scale(1.5) translateY(-50px);
            transition: opacity 0.5s ease-out, transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stacked-photo img {
            max-width: 100%;
            max-height: 380px;
            width: auto;
            height: auto;
            object-fit: contain;
            display: block;
        }

        .stacked-photo.active {
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .stacked-photo.falling {
            opacity: 0;
            transition: transform 1.2s cubic-bezier(0.5, 0, 1, 0.5), opacity 1s ease-in;
        }
    </style>
</head>
<body>

    <h1 class="header-title">우리들의 소중한 기억</h1>
    <div id="photo-container"></div>

<script>
    const TOTAL_PHOTOS = 126; // 더 넓게 쓰므로 장수를 조금 늘려도 예쁩니다
    const IMAGE_EXTENSION = 'jpg';
    const SHOW_INTERVAL = 1000; // 조금 더 빠르게 1초 간격
    const WAIT_BEFORE_CLEAR = 5000; 

    const container = document.getElementById('photo-container');
    let currentIndex = 1;

    function addPhoto() {
        if (currentIndex > TOTAL_PHOTOS) {
            setTimeout(clearPhotos, WAIT_BEFORE_CLEAR);
            return;
        }

        const imgFrame = document.createElement('div');
        imgFrame.className = 'stacked-photo';
        
        const img = document.createElement('img');
        img.src = `photos/${currentIndex}.${IMAGE_EXTENSION}`;
        
        img.onerror = function() {
            imgFrame.remove();
            currentIndex++;
            addPhoto();
        };

        img.onload = function() {
            imgFrame.appendChild(img);
            container.appendChild(imgFrame);

            // --- [핵심 수정] 860x1034 전체 범위를 사용하도록 계산 ---
            // 사진 너비가 300px이므로 -100px ~ 660px 사이에서 랜덤하게 발생 (모서리 허용)
            const randomX = Math.floor(Math.random() * (860 - 200)) - 50; 
            // 세로 역시 모서리를 쓰기 위해 범위를 크게 잡음
            const randomY = Math.floor(Math.random() * (1034 - 300)) - 20;

            // 제목(상단 중앙)을 너무 가리지 않게 필터링하는 로직 (선택 사항)
            // 만약 상단 중앙 근처라면 위치를 다시 조정함
            let finalX = randomX;
            let finalY = randomY;
            if (finalY < 150 && (finalX > 200 && finalX < 450)) {
                finalY += 200; // 제목 영역이면 아래로 밀기
            }

            const randomRotate = Math.floor(Math.random() * 60) - 30; // 회전각도도 더 과감하게 (-30~30)

            imgFrame.style.left = `${finalX}px`;
            imgFrame.style.top = `${finalY}px`;
            imgFrame.dataset.rotate = randomRotate;

            setTimeout(() => {
                imgFrame.style.transform = `rotate(${randomRotate}deg) scale(1)`;
                imgFrame.classList.add('active');
            }, 50);

            currentIndex++;
            setTimeout(addPhoto, SHOW_INTERVAL);
        };
    }

    function clearPhotos() {
        const photos = Array.from(document.querySelectorAll('.stacked-photo'));
        const shuffledPhotos = photos.sort(() => Math.random() - 0.5);

        shuffledPhotos.forEach((photo, index) => {
            const delay = Math.random() * 1500; 
            setTimeout(() => {
                const currentRotate = parseFloat(photo.dataset.rotate);
                const extraRotate = (Math.random() > 0.5 ? 180 : -180);
                photo.style.transform = `translateY(1200px) rotate(${currentRotate + extraRotate}deg)`;
                photo.classList.add('falling');
            }, delay);
        });

        setTimeout(() => {
            container.innerHTML = '';
            currentIndex = 1;
            addPhoto();
        }, 4000); 
    }

    addPhoto();
</script>

</body>
</html>
